---
layout: project-default
code: pnn
title: PNN
tagline: How to optimize?
---

This tutorial shows how to optimize a Probabilistic neural network from the library [PNN](http://pnn.chasset.net) of the R statistical software. We suppose that you know how to install PNN and how to use it.

Before finding a best value of sigma, we need to get a working Probabilistic neural network:

```
> library(pnn)
> set.seed(1)
> data(norms, package = "pnn")
> pnn <- learn(norms)
```

We can launch the optimization process with the following code.

```
> pnn <- smooth(pnn)
```

It uses a genetic algorithm to find the best sigma value. You can have a look to the message generated by the 'rgenoud' package during the optimization process.

```
Mon May 13 13:28:25 2013
Domains:
 0.000000e+00   <=  X1   <=    1.000000e+01 

Data Type: Floating Point
Operators (code number, name, population) 
    (1) Cloning...........................  0
    (2) Uniform Mutation..................  1
    (3) Boundary Mutation.................  1
    (4) Non-Uniform Mutation..............  1
    (5) Polytope Crossover................  1
    (6) Simple Crossover..................  2
    (7) Whole Non-Uniform Mutation........  1
    (8) Heuristic Crossover...............  2
    (9) Local-Minimum Crossover...........  0

HARD Maximum Number of Generations: 100
Maximum Nonchanging Generations: 2
Population size       : 10
Convergence Tolerance: 1.000000e+00

Using the BFGS Derivative Based Optimizer on the Best Individual Each Generation.
Checking Gradients before Stopping.
Using Out of Bounds Individuals.

Minimization Problem.
GENERATION: 0 (initializing the population)
Fitness value... 5.700000e+01
mean............ 1.673000e+02
variance........ 1.785610e+03
#unique......... 10, #Total UniqueCount: 10
var 1:
best............ 1.652360e+00
mean............ 4.640593e+00
variance........ 7.246425e+00

GENERATION: 1
Fitness value... 2.900000e+01
mean............ 1.119000e+02
variance........ 4.543890e+03
#unique......... 6, #Total UniqueCount: 16
var 1:
best............ 7.178603e-01
mean............ 2.414197e+00
variance........ 1.741359e+00

GENERATION: 2
Fitness value... 2.900000e+01
mean............ 3.560000e+01
variance........ 1.154400e+02
#unique......... 5, #Total UniqueCount: 21
var 1:
best............ 7.178603e-01
mean............ 7.962806e-01
variance........ 2.328216e-01

GENERATION: 3
Fitness value... 2.900000e+01
mean............ 4.560000e+01
variance........ 2.317440e+03
#unique......... 6, #Total UniqueCount: 27
var 1:
best............ 7.178603e-01
mean............ 9.771646e-01
variance........ 8.848034e-01

GENERATION: 4
Fitness value... 2.900000e+01
mean............ 3.970000e+01
variance........ 9.472100e+02
#unique......... 6, #Total UniqueCount: 33
var 1:
best............ 7.178603e-01
mean............ 8.906618e-01
variance........ 3.051449e-01

'wait.generations' limit reached.
No significant improvement in 2 generations.

Solution Fitness Value: 2.900000e+01

Parameters at the Solution (parameter, gradient):

 X[ 1] :    7.178603e-01    G[ 1] : 0.000000e+00

Solution Found Generation 1
Number of Generations Run 4

Mon May 13 13:35:56 2013
Total run time : 0 hours 7 minutes and 31 seconds
```
